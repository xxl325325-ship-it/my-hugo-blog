{{ if .Params.password }}
<script>
(function() {
  const correctPassword = '{{ .Params.password }}';
  const contentWrapper = document.querySelector('.post-content, .single-content, main');
  
  if (!contentWrapper) return;
  
  // ä¿å­˜åŸå§‹å†…å®¹
  const originalContent = contentWrapper.innerHTML;
  
  // åˆ›å»ºå¯†ç è¾“å…¥ç•Œé¢
  function createPasswordPrompt() {
    contentWrapper.innerHTML = `
      <div style="text-align: center; padding: 50px 20px; max-width: 400px; margin: 0 auto;">
        <h3 style="color: #333; margin-bottom: 20px;">ğŸ”’ è¯·è¾“å…¥å¯†ç æŸ¥çœ‹å†…å®¹</h3>
        <input type="password" id="passwordInput" placeholder="è¯·è¾“å…¥å¯†ç " 
               style="padding: 12px; width: 100%; border: 2px solid #ddd; border-radius: 5px; margin-bottom: 15px; font-size: 16px;">
        <button id="submitPassword" style="padding: 12px 24px; background: #007cba; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 16px;">ç¡®è®¤</button>
        <p id="errorMsg" style="color: red; margin-top: 10px; display: none;">å¯†ç é”™è¯¯ï¼Œè¯·é‡è¯•</p>
      </div>
    `;
    
    document.getElementById('submitPassword').addEventListener('click', checkPassword);
    document.getElementById('passwordInput').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') checkPassword();
    });
  }
  
  // æ£€æŸ¥å¯†ç 
  function checkPassword() {
    const input = document.getElementById('passwordInput').value;
    const errorMsg = document.getElementById('errorMsg');
    
    if (input === correctPassword) {
      // å¯†ç æ­£ç¡®ï¼Œæ˜¾ç¤ºå†…å®¹
      contentWrapper.innerHTML = originalContent;
      // ä¿å­˜sessionçŠ¶æ€
      sessionStorage.setItem('unlocked-{{ .RelPermalink }}', 'true');
    } else {
      // å¯†ç é”™è¯¯
      errorMsg.style.display = 'block';
      document.getElementById('passwordInput').value = '';
      document.getElementById('passwordInput').focus();
    }
  }
  
  // æ£€æŸ¥æ˜¯å¦å·²ç»è§£é”
  function checkUnlocked() {
    if (sessionStorage.getItem('unlocked-{{ .RelPermalink }}') === 'true') {
      // å·²è§£é”ï¼Œæ˜¾ç¤ºå†…å®¹
      return;
    }
    createPasswordPrompt();
  }
  
  // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥
  checkUnlocked();
})();
</script>
{{ end }}